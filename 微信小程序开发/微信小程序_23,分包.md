---
title: 微信小程序_23,分包

author: icestone
tags:
- 微信小程序
- 微信小程序
- 小程序
- 前端

categories:  
  - 分包指的是把一个完整的小程序项目,按照需求划分为不同的子包,在构建时,打包成不同的分包,用户在使用时按需进行加载。2.当用户进入分包内某个页面时,客户端会把对应分包下载来,下载完成之后再进行展示。同时,还要在app.json的subpackages节点中声明分包的结构。在package.json中写下分包的配置,保存后会自动创建。1.在小程序启动时,默认会下载主包并启动主包内页面。指定的是分包的所在文件夹,指定的是该分包下的页面。在app.json中。  

created: Fri Sep 16 2022 00:00:00 GMT+0800 (中国标准时间)
---
> 什么是分包:

分包指的是把一个完整的小程序项目,按照需求划分为不同的子包,在构建时,打包成不同的分包,用户在使用时按需进行加载

> 分包的好处:

*   可以优化小程序首次启动的下载时间
*   在多团队共同开发时可以更好的解耦协作

> 分包前后项目的构成：

分包后小程序项目由1个主包和多个分包资源组成:

*   主包:一般只包含项目的启动页面和TabBar页面,以及所有分包都需要用到的一些公共资源
*   分包:只包含和当前分包有关的页面和私有资源

![在这里插入图片描述](https://img-blog.csdnimg.cn/9bd307cd883f4b0f9f6bbc470aa8799c.png)

> 分包的加载规则:

1.在小程序启动时,默认会下载主包并启动主包内页面

*   tabBar页面需要放到主包中

2.当用户进入分包内某个页面时,客户端会把对应分包下载来,下载完成之后再进行展示

*   非tabBar页面可以按照功能的不同,划分为不同的分包之后,进行按需下载

目前,小程序分包的大小有以下两个限制:

*   整个小程序所有分包大小不超过16M(主包+所有分包)
*   单个分包/主包大小不能超过2M

> 使用分包

1.配置方法:

![在这里插入图片描述](https://img-blog.csdnimg.cn/2dcb6e6c6d23498298e865633026172c.png)  
![在这里插入图片描述](https://img-blog.csdnimg.cn/5586ac3165084219b4548c12cb6a12be.png)  
同时,还要在app.json的subpackages节点中声明分包的结构

配置自己的分包:  
![在这里插入图片描述](https://img-blog.csdnimg.cn/b3e448eeef0645c384f06703faf721bb.png)  
在package.json中写下分包的配置,保存后会自动创建  
![在这里插入图片描述](https://img-blog.csdnimg.cn/b3d1e095ee384f9092ae181e768acf35.png)  
代码:

    "subpackages": [{
        "root": "pkgA",
        "pages": [
          "pages/cat/cat",
          "pages/dog/dog"
        ]
      },{
        "root": "pkgB",
        "pages": [
          "pages/apple/apple"
        ]
      }],
    

在上面示例中,`root`指定的是分包的所在文件夹,`pages`指定的是该分包下的页面

> 为分包起别名:

在app.json中`subpackages`下的对象中使用name节点起别名:

     "subpackages": [{
        "root": "pkgA",
        "name":"p1",
        "pages": [
          "pages/cat/cat",
          "pages/dog/dog"
        ]
      },{
        "root": "pkgB",
        "name":"p2",
        "pages": [
          "pages/apple/apple"
        ]
      }],
    

> 如何知道每个分包的体积:

详情里面可以看到  
![在这里插入图片描述](https://img-blog.csdnimg.cn/8a4ecae9ff3c4505a73ec803ff922238.png)

> 打包原则:

1.小程序会按subpackages的配置进行分包,subpackages之外的目录将打包到主包中  
2.主包也可以用自己的pages(即最外层的pages字段)  
3.tabBar页面必须在主包内  
4.分包之间不能互相嵌套

> 引用原则:

1.主包无法引用分包内的私有资源  
2.分包之间不能互相引用私有资源  
3.分包可以引用主包内的公共资源

> 独立分包:

独立分包本质上也是主包,只不过它比较特殊,可以独立于主包和其他分包而单独运行

![在这里插入图片描述](https://img-blog.csdnimg.cn/60480bf72d054083850deb5e99de12b7.png)

独立分包和普通分包的区别:是否依赖于主包才能运行

*   普通分包必须依赖于主包才能运行
*   独立分包可以在不下载主包的情况下,独立运行

> 独立分包的应用场景:

开发者可以按需,将某些具有一定功能性的页面配置到独立分包中,原因如下:

*   当小程序从普通的分包页面启动时,需要首先下载主包
*   而独立分包不依赖主包即可运行.可以很大程度上提升分���页面的启动速度

注意:一个小程序可以有多个独立分包

独立分包的配置方法:

![在这里插入图片描述](https://img-blog.csdnimg.cn/aa7a534751d949008fe9a950bfcd6b04.png)  
独立分包和普通分包的区别就在于它有没有`"independent": true`节点,例如下面的pkgB就是一耳光独立分包:

      "subpackages": [{
        "root": "pkgA",
        "name":"p1",
        "pages": [
          "pages/cat/cat",
          "pages/dog/dog"
        ]
      },{
        "root": "pkgB",
        "name":"p2",
        "pages": [
          "pages/apple/apple"
        ],
        "independent": true
      }],
    

> 独立分包的引用原则:

独立分包和普通分包以及主包之间,是相互隔绝的,不能相互引用彼此的资源,例如:

1.主包无法引用独立分包内的私有资源  
2.独立分包之间,不能相互引用  
3.独立分包和普通分包之间,不能相互引用私有资源  
4.特别注意:独立分包中不能引用主包内的公共资源